"use strict";(self.webpackChunkFreshcart=self.webpackChunkFreshcart||[]).push([[557],{5557:(b,m,l)=>{l.r(m),l.d(m,{ForgetPasswordComponent:()=>N});var p=l(6814),n=l(95),c=l(3519),a=l.n(c),t=l(4769),d=l(9862);let u=(()=>{class s{constructor(o){this._HttpClient=o,this.baseUrl="https://ecommerce.routemisr.com/api/v1/auth"}forgetPassword(o){return this._HttpClient.post(this.baseUrl+"/forgotPasswords",o)}resetCode(o){return this._HttpClient.post(this.baseUrl+"/verifyResetCode",o)}resetNewPassword(o){return this._HttpClient.put(this.baseUrl+"/resetPassword",o)}static#t=this.\u0275fac=function(e){return new(e||s)(t.LFG(d.eN))};static#e=this.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var f=l(1120);function g(s,i){1&s&&(t.TgZ(0,"p"),t._uU(1," Email Is Required "),t.qZA())}function _(s,i){1&s&&(t.TgZ(0,"p"),t._uU(1,"Email Not Valid"),t.qZA())}function w(s,i){if(1&s&&(t.TgZ(0,"div",8),t.YNc(1,g,2,0,"p",9),t.YNc(2,_,2,0,"p",9),t.qZA()),2&s){const o=t.oxw(2);let e,r;t.xp6(1),t.Q6J("ngIf",null==(e=o.step1Form.get("email"))?null:e.getError("required")),t.xp6(1),t.Q6J("ngIf",null==(r=o.step1Form.get("email"))?null:r.getError("email"))}}function h(s,i){if(1&s){const o=t.EpF();t.TgZ(0,"section",1)(1,"form",2),t.NdJ("ngSubmit",function(){t.CHM(o);const r=t.oxw();return t.KtG(r.forgetPassword())}),t.TgZ(2,"div")(3,"label",3),t._uU(4,"Email : "),t.qZA(),t._UZ(5,"input",4,5),t.qZA(),t.TgZ(7,"button",6),t._uU(8," Forgot Password "),t.qZA(),t.YNc(9,w,3,2,"div",7),t.qZA()()}if(2&s){const o=t.MAs(6),e=t.oxw();let r;t.xp6(1),t.Q6J("formGroup",e.step1Form),t.xp6(6),t.Q6J("disabled",e.step1Form.invalid),t.xp6(2),t.Q6J("ngIf",(null==(r=e.step1Form.get("email"))?null:r.errors)&&((null==(r=e.step1Form.get("email"))?null:r.touched)||o.value.length>0))}}function F(s,i){1&s&&(t.TgZ(0,"p"),t._uU(1," resetCode Is Required "),t.qZA())}function x(s,i){if(1&s&&(t.TgZ(0,"div",8),t.YNc(1,F,2,0,"p",9),t.qZA()),2&s){const o=t.oxw(2);let e;t.xp6(1),t.Q6J("ngIf",null==(e=o.step2Form.get("resetCode"))?null:e.getError("required"))}}function C(s,i){if(1&s){const o=t.EpF();t.TgZ(0,"section",1)(1,"form",2),t.NdJ("ngSubmit",function(){t.CHM(o);const r=t.oxw();return t.KtG(r.resetCode())}),t.TgZ(2,"div")(3,"label",10),t._uU(4,"Reset Code : "),t.qZA(),t._UZ(5,"input",11,12),t.qZA(),t.TgZ(7,"button",6),t._uU(8," Reset Code "),t.qZA(),t.YNc(9,x,2,1,"div",7),t.qZA()()}if(2&s){const o=t.MAs(6),e=t.oxw();let r;t.xp6(1),t.Q6J("formGroup",e.step2Form),t.xp6(6),t.Q6J("disabled",e.step2Form.invalid),t.xp6(2),t.Q6J("ngIf",(null==(r=e.step2Form.get("resetCode"))?null:r.errors)&&((null==(r=e.step2Form.get("resetCode"))?null:r.touched)||o.value.length>0))}}function v(s,i){1&s&&(t.TgZ(0,"p"),t._uU(1," New Password Is Required "),t.qZA())}function P(s,i){1&s&&(t.TgZ(0,"p"),t._uU(1," New Password Not Valid "),t.qZA())}function Z(s,i){if(1&s&&(t.TgZ(0,"div",8),t.YNc(1,v,2,0,"p",9),t.YNc(2,P,2,0,"p",9),t.qZA()),2&s){const o=t.oxw(2);let e,r;t.xp6(1),t.Q6J("ngIf",null==(e=o.step3Form.get("newPassword"))?null:e.getError("required")),t.xp6(1),t.Q6J("ngIf",null==(r=o.step3Form.get("newPassword"))?null:r.getError("pattern"))}}function T(s,i){if(1&s){const o=t.EpF();t.TgZ(0,"section",1)(1,"form",2),t.NdJ("ngSubmit",function(){t.CHM(o);const r=t.oxw();return t.KtG(r.resetNewPassword())}),t.TgZ(2,"div")(3,"label",13),t._uU(4,"Reset New Password : "),t.qZA(),t._UZ(5,"input",14,15),t.qZA(),t.TgZ(7,"button",6),t._uU(8," Reset New Password "),t.qZA(),t.YNc(9,Z,3,2,"div",7),t.qZA()()}if(2&s){const o=t.MAs(6),e=t.oxw();let r;t.xp6(1),t.Q6J("formGroup",e.step3Form),t.xp6(6),t.Q6J("disabled",e.step3Form.invalid),t.xp6(2),t.Q6J("ngIf",(null==(r=e.step3Form.get("newPassword"))?null:r.errors)&&((null==(r=e.step3Form.get("newPassword"))?null:r.touched)||o.value.length>0))}}let N=(()=>{class s{constructor(o,e){this._ForgetpasswordService=o,this._Router=e,this.step1=!0,this.step2=!1,this.step3=!1,this.userEmail="",this.step1Form=new n.cw({email:new n.NI("",[n.kI.required,n.kI.email])}),this.step2Form=new n.cw({resetCode:new n.NI("",[n.kI.required])}),this.step3Form=new n.cw({newPassword:new n.NI("",[n.kI.required,n.kI.pattern(/^[A-Z][a-z0-9]{6,20}$/)])})}forgetPassword(){let o=this.step1Form.value;this.userEmail=o.email,this._ForgetpasswordService.forgetPassword(o).subscribe({next:e=>{console.log(e),"success"==e.statusMsg&&(this.step1=!1,this.step2=!0,a().fire({position:"top-end",icon:"success",title:e.message,showConfirmButton:!1,timer:1e3}))},error:e=>{console.log(e),a().fire({position:"top-end",icon:"warning",title:e.error.message,showConfirmButton:!1,timer:2e3})}})}resetCode(){this._ForgetpasswordService.resetCode(this.step2Form.value).subscribe({next:e=>{console.log(e),"Success"==e.status&&(this.step2=!1,this.step3=!0,a().fire({position:"top-end",icon:"success",title:e.status,showConfirmButton:!1,timer:1500}))},error:e=>{console.log(e),a().fire({position:"top-end",icon:"warning",title:e.error.message,showConfirmButton:!1,timer:2e3})}})}resetNewPassword(){let o=this.step3Form.value;o.email=this.userEmail,this._ForgetpasswordService.resetNewPassword(o).subscribe({next:e=>{console.log(e),e.token&&(localStorage.setItem("userToken",e.token),a().fire({position:"top-end",icon:"success",title:e.message,showConfirmButton:!1,timer:1e3}),this._Router.navigate(["./home"]),this.step1=!0,this.step2=!1,this.step3=!1)},error:e=>{console.log(e),a().fire({position:"top-end",icon:"warning",title:e.error.message,showConfirmButton:!1,timer:2e3})}})}static#t=this.\u0275fac=function(e){return new(e||s)(t.Y36(u),t.Y36(f.F0))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-forget-password"]],standalone:!0,features:[t.jDz],decls:3,vars:3,consts:[["class","p-4 my-5 w-50 mx-auto bg-main-light rounded-2 shadow",4,"ngIf"],[1,"p-4","my-5","w-50","mx-auto","bg-main-light","rounded-2","shadow"],[3,"formGroup","ngSubmit"],["for","email",1,"fw-semibold","text-main"],["formControlName","email","type","email","id","email",1,"form-control","mt-2"],["inputEmail",""],[1,"main-btn","w-75","d-block","mx-auto","my-3",3,"disabled"],["class","alert alert-danger",4,"ngIf"],[1,"alert","alert-danger"],[4,"ngIf"],["for","resetCode",1,"fw-semibold","text-main"],["formControlName","resetCode","type","text","id","resetCode",1,"form-control","mt-2"],["resetCodew",""],["for","newPassword",1,"fw-semibold","text-main"],["formControlName","newPassword","type","password","id","newPassword",1,"form-control","mt-2"],["newPassword",""]],template:function(e,r){1&e&&(t.YNc(0,h,10,3,"section",0),t.YNc(1,C,10,3,"section",0),t.YNc(2,T,10,3,"section",0)),2&e&&(t.Q6J("ngIf",r.step1),t.xp6(1),t.Q6J("ngIf",r.step2),t.xp6(1),t.Q6J("ngIf",r.step3))},dependencies:[p.ez,p.O5,n.UX,n._Y,n.Fj,n.JJ,n.JL,n.sg,n.u]})}return s})()}}]);